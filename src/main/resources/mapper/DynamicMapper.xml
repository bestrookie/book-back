<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bestrookie.mapper.DynamicMapper">
    <resultMap id="userInfo" type="UserPojo">
        <id column="user_id" property="userId"></id>
        <result column="user_name" property="userName"/>
        <result column="user_password" property="password"/>
        <result column="user_photo" property="image"/>
        <result column="user_coin" property="userCoin"/>
        <result column="user_role" property="role"/>
        <result column="user_phone" property="userPhone"/>
    </resultMap>
    <resultMap id="dynamicInfo" type="DynamicPojo">
        <id column="d_id" property="dId"></id>
        <result column="user_id" property="userId"/>
        <result column="d_date" property="dDate"/>
        <result column="d_content" property="dContent"/>
        <result column="d_abstract" property="dAbstract"/>
        <result column="bd_id" property="bdId"/>
        <association property="user"  resultMap="userInfo">
            <id column="user_id" property="userId"></id>
            <result column="user_name" property="userName"/>
            <result column="user_password" property="password"/>
            <result column="user_photo" property="image"/>
            <result column="user_coin" property="userCoin"/>
            <result column="user_role" property="role"/>
            <result column="user_phone" property="userPhone"/>
        </association>
    </resultMap>
<!--    分页查询动态信息-->
    <select id="queryDynamic" resultMap="dynamicInfo">
    SELECT  * FROM book_db.dynamic
    join book_db.user
    on book_db.dynamic.user_id = book_db.user.user_id
    WHERE book_db.dynamic.bd_id = #{discussionId} ORDER BY book_db.dynamic.d_date DESC
    </select>
<!--    添加动态信息-->
    <insert id="addDynamic" parameterType="com.bestrookie.pojo.DynamicPojo">
        INSERT INTO book_db.dynamic (user_id,d_date,d_content,d_abstract,bd_id) value (#{userId},#{dDate},#{dContent},#{dAbstract},#{bdId})
    </insert>

</mapper>